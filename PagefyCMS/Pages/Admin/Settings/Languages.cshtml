@page
@model PagefyCMS.Pages.Admin.Settings.LanguagesModel
@{
    Layout = "_AdminLayout";
    ViewData["Title"] = "Language Management";
}

<div class="container">
    <h2><i class="bi bi-translate"></i> Language Management</h2>

    @if (Model.Message != null)
    {
        <div class="alert alert-info"><i class="bi bi-info-circle"></i> @Model.Message</div>
    }

    @if (Model.Error != null)
    {
        <div class="alert alert-danger"><i class="bi bi-exclamation-circle"></i> @Model.Error</div>
    }

    <div class="row">
        <!-- Upload Language File -->
        <div class="col-md-6">
            <div class="card mb-4">
                <div class="card-header">
                    <i class="bi bi-cloud-arrow-up"></i> Upload Language File
                </div>
                <div class="card-body">
                    <form method="post" enctype="multipart/form-data" asp-page-handler="Upload">
                        <div class="mb-3">
                            <label for="languageName" class="form-label">Language Code (e.g., en, sv, de)</label>
                            <input type="text" id="languageName" name="LanguageName" class="form-control" placeholder="en" required />
                        </div>
                        <div class="mb-3">
                            <label for="languageFile" class="form-label">Language File (JSON)</label>
                            <input type="file" id="languageFile" name="LanguageFile" class="form-control" accept=".json" required />
                        </div>
                        <small class="text-muted">
                            JSON format: { "key": "value", "another_key": "another value" }
                        </small>
                        <br /><br />
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-upload"></i> Upload Language
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Download Template -->
        <div class="col-md-6">
            <div class="card mb-4">
                <div class="card-header">
                    <i class="bi bi-cloud-arrow-down"></i> Download Template
                </div>
                <div class="card-body">
                    <p>Download the default English language template to use as a basis for translation.</p>
                    <form method="post" asp-page-handler="Download">
                        <button type="submit" class="btn btn-success">
                            <i class="bi bi-download"></i> Download en.json Template
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Available Languages -->
    <div class="card">
        <div class="card-header">
            <i class="bi bi-list"></i> Available Languages
        </div>
        <div class="card-body">
            @if (Model.AvailableLanguages != null && Model.AvailableLanguages.Count > 0)
            {
                <div class="list-group">
                    @foreach (var lang in Model.AvailableLanguages)
                    {
                        <div class="list-group-item d-flex justify-content-between align-items-center">
                            <span>
                                <i class="bi bi-file-earmark-text"></i>
                                <strong>@lang.ToUpper()</strong>.json
                            </span>
                            <form method="post" asp-page-handler="Delete" style="display:inline;">
                                <input type="hidden" name="LanguageName" value="@lang" />
                                <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Are you sure?')">
                                    <i class="bi bi-trash"></i> Delete
                                </button>
                            </form>
                        </div>
                    }
                </div>
            }
            else
            {
                <p class="text-muted">No language files found. Upload a language file to get started.</p>
            }
        </div>
    </div>
</div>

<style>
    .card-header {
        background-color: #f8f9fa;
        font-weight: bold;
    }
    .list-group-item {
        padding: 1rem;
    }
</style>
