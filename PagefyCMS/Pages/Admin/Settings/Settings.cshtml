@page
@model PagefyCMS.Pages.Admin.Settings.SettingsModel
@{
    Layout = "_AdminLayout";
    ViewData["Title"] = "Settings";
}

<div class="container">
    <h2><i class="bi bi-gear"></i> Site Settings</h2>

    @if (Model.Saved)
    {
        <div class="alert alert-success"><i class="bi bi-check-circle"></i> Settings saved successfully!</div>
    }

    <form method="post">
        <div class="row">
            <!-- Basic Settings -->
            <div class="col-md-6">
                <div class="card mb-4">
                    <div class="card-header">
                        <i class="bi bi-info-circle"></i> Basic Settings
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label for="siteTitle" class="form-label">Site Name</label>
                            <input type="text" id="siteTitle" name="SiteTitle" value="@Model.SiteTitle" class="form-control" required />
                        </div>

                        <div class="mb-3">
                            <label for="editorType" class="form-label">Editor Choice</label>
                            <select id="editorType" name="EditorType" class="form-select">
                                <option value="tinymce" selected="@(Model.EditorType == "tinymce" ? "selected" : null)">TinyMCE</option>
                                <option value="toastui" selected="@(Model.EditorType == "toastui" ? "selected" : null)">Toast UI Editor</option>
                            </select>
                        </div>

                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="editorEnabled" name="EditorEnabled" value="true" @(Model.EditorEnabled ? "checked" : "") />
                            <label class="form-check-label" for="editorEnabled">Enable editor for pages and articles</label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Theme Selector -->
            <div class="col-md-6">
                <div class="card mb-4">
                    <div class="card-header">
                        <i class="bi bi-palette"></i> Theme
                    </div>
                    <div class="card-body">
                        <label for="activeTheme" class="form-label">Choose theme for website</label>
                        <select id="activeTheme" name="ActiveTheme" class="form-select mb-3" onchange="updateThemePreview(this.value)">
                            <option value="site" selected="@(Model.ActiveTheme == "site" ? "selected" : null)">🎨 Future Design (Default)</option>
                            <option value="neon-cyberpunk" selected="@(Model.ActiveTheme == "neon-cyberpunk" ? "selected" : null)">⚡ Neon Cyberpunk</option>
                            <option value="professional-midnight" selected="@(Model.ActiveTheme == "professional-midnight" ? "selected" : null)">💼 Professional Midnight</option>
                            <option value="news-hub" selected="@(Model.ActiveTheme == "news-hub" ? "selected" : null)">📰 News Hub</option>
                            <option value="gaming-edge" selected="@(Model.ActiveTheme == "gaming-edge" ? "selected" : null)">🎮 Gaming Edge</option>
                            <option value="minimalist-clean" selected="@(Model.ActiveTheme == "minimalist-clean" ? "selected" : null)">✨ Minimalist Clean</option>
                            <option value="aurora-gradient" selected="@(Model.ActiveTheme == "aurora-gradient" ? "selected" : null)">🌌 Aurora Gradient</option>
                        </select>

                        <div id="themePreviewContainer" class="mb-3 text-center">
                            <img id="themePreviewImage" src="" alt="Theme Preview" class="img-fluid border rounded shadow-sm" style="max-height: 200px; display: none;" />
                            <p id="themePreviewText" class="text-muted mt-2" style="display: none;">No preview available</p>
                        </div>

                        <div class="alert alert-info">
                            <i class="bi bi-info-circle"></i>
                            <small>
                                <strong>Theme Guide:</strong><br>
                                🎨 Future Design - Modern theme with blue/purple gradients<br>
                                ⚡ Neon Cyberpunk - Futuristic neon design<br>
                                💼 Professional - Classic for business<br>
                                📰 News Hub - Optimized for news website<br>
                                🎮 Gaming Edge - For gaming and gaming news<br>
                                ✨ Minimalist - Clean and simple<br>
                                🌌 Aurora - Northern lights inspired
                            </small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <button type="submit" class="btn btn-primary btn-lg">
            <i class="bi bi-save"></i> Save Changes
        </button>
    </form>
</div>

<style>
    .alert-info {
        font-size: 0.9rem;
        line-height: 1.6;
    }
</style>

<script>
function updateThemePreview(theme) {
    const previewImage = document.getElementById('themePreviewImage');
    const previewText = document.getElementById('themePreviewText');

    // Map 'site' to 'framtidsdesign' as per directory structure
    let themePath = theme;
    if (theme === 'site') {
        themePath = 'framtidsdesign';
    }

    // Construct the path to the preview image
    const imagePath = `/themes/${themePath}/preview.jpg`;

    // Update the image source
    previewImage.src = imagePath;
    previewImage.style.display = 'block';
    previewText.style.display = 'none';

    // Handle image load error
    previewImage.onerror = function() {
        previewImage.style.display = 'none';
        previewText.style.display = 'block';
        previewText.textContent = 'Preview not available for ' + theme;
    };
}

// Initialize preview on page load
document.addEventListener('DOMContentLoaded', function() {
    const activeTheme = document.getElementById('activeTheme').value;
    updateThemePreview(activeTheme);
});
</script>
